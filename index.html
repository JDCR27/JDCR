<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cartas ‚Äî Colecci√≥n</title>
  <meta name="description" content="Sitio simple para subir/publicar cartas: b√∫squeda, filtros, lectura y descarga." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0f14;       /* fondo oscuro elegante */
      --card: #121821;     /* tarjetas */
      --text: #e8eef7;     /* texto principal */
      --muted: #9db0c9;    /* texto secundario */
      --accent: #6aa2ff;   /* acento */
      --accent-2: #8ef;    /* acento claro */
      --border: #223044;   /* bordes */
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: linear-gradient(120deg, #0a0e13 0%, #0d1520 50%, #0b0f14 100%);
      color: var(--text);
    }
    .container { max-width: 1100px; margin: 0 auto; padding: 24px; }
    header { display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom: 20px; }
    .brand { display:flex; align-items:center; gap:12px; }
    .logo { width:40px; height:40px; border-radius:12px; background: radial-gradient(circle at 30% 30%, var(--accent), #214); box-shadow: var(--shadow); }
    h1 { font-size: clamp(22px, 3vw, 30px); margin: 0; letter-spacing:.3px; }
    .muted { color: var(--muted); }

    .toolbar { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .input, .select {
      background: #0e1520; border: 1px solid var(--border); color: var(--text);
      padding: 10px 12px; border-radius: 12px; outline:none;
      box-shadow: inset 0 0 0 9999px rgba(255,255,255,0);
      transition: border .2s, box-shadow .2s, transform .08s ease;
    }
    .input:focus, .select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(106,162,255,.18); }
    .btn {
      background: linear-gradient(180deg, #1b2a44, #142033);
      color: var(--text);
      border: 1px solid var(--border);
      padding: 10px 14px; border-radius: 12px; cursor: pointer; font-weight: 600;
      transition: transform .08s ease, filter .2s, border .2s;
    }
    .btn:hover { filter: brightness(1.08); }
    .btn:active { transform: translateY(1px) scale(0.99); }
    .btn-ghost { background: transparent; border: 1px dashed var(--border); }

    .grid { display:grid; grid-template-columns: repeat( auto-fit, minmax(260px, 1fr) ); gap:16px; }
    .card { background: var(--card); border:1px solid var(--border); border-radius: 18px; padding: 16px; box-shadow: var(--shadow); position: relative; overflow: hidden; }
    .card h3 { margin: 0 0 8px; font-size: 18px; }
    .tags { display:flex; gap:8px; flex-wrap:wrap; margin-top: 8px; }
    .tag { font-size:12px; padding:6px 10px; border-radius:99px; border:1px solid var(--border); color: var(--muted); background:#0d1420; }
    .card .meta { font-size: 12px; color: var(--muted); display:flex; align-items:center; gap:8px; }
    .card .actions { display:flex; gap:8px; margin-top: 12px; }

    .pill { font-size:11px; padding:6px 10px; border-radius:99px; background:#0e1622; border:1px solid var(--border); color: var(--muted); }

    .empty { text-align:center; padding: 40px 10px; border:1px dashed var(--border); border-radius: 16px; color: var(--muted); }

    /* Modal */
    dialog { width: min(920px, 96vw); max-height: 90vh; border:1px solid var(--border); border-radius: 16px; background: #0e1520; color: var(--text); box-shadow: var(--shadow); }
    dialog::backdrop { backdrop-filter: blur(6px); background: rgba(8,12,18,.6); }
    .modal-head { display:flex; align-items:center; justify-content:space-between; gap:10px; padding: 14px 16px; border-bottom: 1px solid var(--border); position: sticky; top:0; background: #0e1520; }
    .modal-title { font-size: 18px; font-weight: 700; margin:0; }
    .modal-body { padding: 16px; overflow:auto; max-height: calc(90vh - 120px); }
    .modal-actions { display:flex; gap:8px; }

    .prose { line-height: 1.7; font-size: 16px; white-space: pre-wrap; }

    footer { margin: 28px 0 10px; text-align:center; color: var(--muted); font-size: 12px; }
    .link { color: var(--accent-2); text-decoration: none; border-bottom: 1px dashed rgba(142,238,255,.3); }

    /* Small helper */
    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Cartas ‚Ä¢ Colecci√≥n</h1>
          <div class="muted" style="font-size:14px">Sube/publica tus cartas y comp√°rtelas f√°cilmente.</div>
        </div>
      </div>
      <div class="toolbar">
        <label class="sr-only" for="q">Buscar</label>
        <input class="input" id="q" type="search" placeholder="Buscar por t√≠tulo, etiqueta o texto‚Ä¶" />
        <select class="select" id="filterTag">
          <option value="">Todas las etiquetas</option>
        </select>
        <button class="btn" id="btnAdd">A√±adir carta</button>
        <button class="btn btn-ghost" id="btnExport" title="Exportar JSON">Exportar</button>
      </div>
    </header>

    <section id="stats" style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px">
      <span class="pill" id="countPill">0 cartas</span>
      <span class="pill" id="filterPill" style="display:none"></span>
    </section>

    <section id="list" class="grid" aria-live="polite"></section>
    <div id="empty" class="empty" style="display:none">No hay resultados.
      <div style="margin-top:8px"><button class="btn btn-ghost" id="clearFilters">Quitar filtros</button></div>
    </div>

    <footer>
      Hecho con ‚ù§Ô∏è ‚Ä¢ Sube este <span>index.html</span> a GitHub Pages y listo. ‚Äî 
      <a class="link" href="#" id="howTo">¬øC√≥mo edito/a√±ado cartas?</a>
    </footer>
  </div>

  <!-- Modal lectura -->
  <dialog id="reader">
    <div class="modal-head">
      <h2 class="modal-title" id="readerTitle">T√≠tulo</h2>
      <div class="modal-actions">
        <button class="btn" id="copyBtn">Copiar</button>
        <button class="btn" id="printBtn">Imprimir</button>
        <button class="btn" id="downloadBtn">Descargar</button>
        <button class="btn btn-ghost" id="closeReader">Cerrar</button>
      </div>
    </div>
    <div class="modal-body">
      <div class="muted" id="readerMeta" style="margin-bottom:8px"></div>
      <article class="prose" id="readerContent"></article>
    </div>
  </dialog>

  <!-- Modal a√±adir/editar -->
  <dialog id="editor">
    <div class="modal-head">
      <h2 class="modal-title" id="editorTitle">Nueva carta</h2>
      <div class="modal-actions">
        <button class="btn" id="saveCard">Guardar</button>
        <button class="btn btn-ghost" id="cancelEdit">Cancelar</button>
      </div>
    </div>
    <div class="modal-body">
      <form id="form" onsubmit="return false;" style="display:grid; gap:10px">
        <div>
          <label for="title">T√≠tulo</label>
          <input id="title" class="input" placeholder="Ej. Carta a‚Ä¶" required />
        </div>
        <div>
          <label for="tags">Etiquetas (separadas por coma)</label>
          <input id="tags" class="input" placeholder="amor, amistad, despedida" />
        </div>
        <div>
          <label for="content">Contenido</label>
          <textarea id="content" class="input" style="min-height: 200px; width:100%" placeholder="Escribe o pega tu carta aqu√≠‚Ä¶" required></textarea>
        </div>
      </form>
    </div>
  </dialog>

  <script>
      const LETTERS = [
      {
        id: crypto.randomUUID(),
        title: "Carta 1 ‚Äî RECUERDOS",
        tags: ["amistad", "agradecimiento"],
        date: "2025-08-10",
        content: `Hola, Gasparina. Bueno‚Ä¶ quer√≠a escribirte unas cuantas cartas en las que, creo yo, pueda plasmar un poco de las cosas que siempre dese√© decirte o, al menos, algunas cuestiones que quedaron en duda para m√≠.
Cuando te vi por primera vez, te digo sin exagerar que sent√≠ una sensaci√≥n de curiosidad, que m√°s adelante termin√≥ convirti√©ndose en sentimientos muy intensos hacia ti. Yo trat√© de ignorarlo, pero no pude; consiguientemente, intent√© acercarme de una forma invasiva y quise forzar que surgiera alg√∫n tipo de lazo social entre t√∫ y yo. Se supone que esas cosas surgen siempre de manera natural. Quiero disculparme por este medio, porque en persona no sabr√≠a elegir bien las palabras. Te pido perd√≥n por las diversas situaciones en las que te viste involucrada por mi culpa, e incluso quiero decirte que a√∫n no olvido esa vez en la que, por la intensidad de todo, terminaste quebr√°ndote en clase. Aunque sea demasiado tarde, quiero decirte que estoy profundamente arrepentido de eso y de otras cosas que pudieron haberte hecho da√±o, solo por el hecho de que t√∫ me gustaras.
Yo‚Ä¶ s√© que nunca llegu√© a entenderte, y, sin embargo, siempre disfrutaba de tu presencia. S√≠, algo tan trivial como el simple hecho de estar cerca de ti era suficiente para ponerme muy feliz y de buen humor. Te mentir√≠a si dijera que hoy en d√≠a no disfruto de tenerte cerca, aunque no hablemos mucho. Solo s√© que eso me transmite una sensaci√≥n de calidez que hasta el d√≠a de hoy no he podido sentir con nadie m√°s. Tambi√©n quiero expresarte que, con lo poco que llegu√© a compartir contigo, comprend√≠ un poco de tu personalidad, y me atrevo a decir que realmente eres y ser√°s alguien a quien considero que vale la pena conocer. Por eso mismo, a veces me arrepiento de no haber sabido aprovechar m√°s el tiempo contigo y de haber esperado hasta que nuestro √∫ltimo a√±o en secundaria estuviera por acabar para reci√©n intentar acercarme a ti.
Quiero agradecerte por haberme tenido paciencia, incluso despu√©s de los malos ratos que te hice pasar.`
      },
      {
        id: crypto.randomUUID(),
        title: "Carta 2 ‚Äî ENTRE RISAS Y MOMENTOS",
        tags: ["amor", "despedida"],
        date: "2025-08-15",
        content: `Cuando me pongo a recordar y pensar detalladamente en estos dos a√±os, siempre llego a la misma conclusi√≥n: ‚ÄúPudiste haber aprovechado mejor el tiempo en conocerla y, por lo menos, haber forjado una peque√±a amistad‚Äù. Y bueno, la √∫nica soluci√≥n que he llegado a contemplar en estos momentos fue aprovechar todo el tiempo posible en estos dos √∫ltimos meses del a√±o para acercarme un poco a ti y compartir momentos, sean buenos o malos. Aunque, por ahora, creo que ser√°n recuerdos buenos. Te digo que me agrada mucho cuando me cuentas tus vivencias o cuando intentas bromear conmigo (aunque no lo parezca). Adem√°s, creo que estamos a mano, puesto que yo tambi√©n te molesto; aunque no se me d√© bien ser bromista, me da risa cuando te enojas y pones esa cara parecida al sticker del oso que tienes en WhatsApp.
Otra cosa que recuerdo es cuando te agarro los cachetes. En parte lo hago porque son bien suavecitos y calentitos, agradables al tacto. Tambi√©n recordar√© siempre c√≥mo escondes tu cara para que no lo haga; sabes, eso se me hace un poco tierno y gracioso cuando lo haces.
Y tampoco olvidar√© los trabajos grupales, cuando nos dices manganzones, o cuando en el aula, por la emoci√≥n ‚Äîimagino yo‚Äî, se te escapaban ciertas palabras como: colorcita, cuando hay hay, y cuando no hay no hay pues, lambido, entre otras cosas que ya no recuerdo bien. Todo eso, te juro, me da mucha risa cuando lo dices. Y bueno, decirte que, si alguien llega a mencionar esas palabras o similares, tengo por seguro que me acordar√© de Marimar jajaja.
Por cierto, no s√© si ser√° alg√∫n perfume o algo que usas, pero te juro que esa fragancia me lleg√≥ a encantar demasiado. Tanto me acostumbr√© a olerla solo en ti, que, si llego a percibir ese aroma en la calle, me confundo y volteo a mirar, por si acaso est√°s cerca.
Y bueno, esto √∫ltimo no quiero olvidarlo: fue en tu cabello donde aprend√≠ a hacer trenzas y donde us√© mi anillo como carm√≠n jajaja. Gracias por dejarme aprender con tu cabello, Marimar.`
      },
      {
        id: crypto.randomUUID(),
        title: "Carta 3 ‚Äî SAKURA",
        tags: ["amor"],
        date: "2025-08-15",
        content: `Fiorela, quiero decirte que sinceramente a√∫n te sigo amando o, al menos, queriendo. El escribirte esto me hace recordar aquella vez en Huanchaco en la que intent√© confesarte mis sentimientos, pero bueno‚Ä¶ me imagino que te diste cuenta de que los nervios me ganaron. Sinceramente, ya ten√≠a previsto aquel rechazo; sin embargo, hubiera preferido un poco m√°s de sinceridad, o incluso un simple ‚Äúno‚Äù por respuesta. Con respecto a mis sentimientos actuales, aunque todav√≠a se desbordan por ti, hace tiempo desist√≠ de querer algo contigo. Y bueno, m√°s que todo porque considero que ya es algo a lo que deb√≠a ponerle un alto. Tambi√©n porque quiz√° t√∫ ya tengas alguna relaci√≥n con alguien, y pues, no deseo volver a ser un fastidio para ti.
Otra cosa que nunca te dije, como ya vengo mencionando en las cartas anteriores, es que tal vez hubiera sido bonito poder formar una amistad contigo. Siempre dese√© que tu trato conmigo fuera igual al que ten√≠as con los dem√°s del sal√≥n. Me refiero a que con ellos eras bromista y cari√±osa, pero conmigo un poco m√°s seria y reservada. S√© el porqu√© de eso, o creo saberlo, pero aun as√≠ me hubiera gustado haber alcanzado ese nivel de confianza contigo. No s√© si realmente las cosas fueron as√≠, pero desde mi perspectiva as√≠ es como lo sent√≠. Quiz√°s, si me hubiera esforzado m√°s en enmendar mis errores contigo, todo habr√≠a sido un poco m√°s agradable para ambos, al tratarnos como amigos.
Ahora recuerdo que me preguntaste qu√© significaba, o por qu√© te puse ‚ÄúSakura‚Äù o ‚Äú√°rbol de sakura‚Äù. En s√≠, la palabra est√° relacionada con una flor muy especial en la cultura japonesa (de la cual soy muy fan, por cierto). Su significado se asocia a la pureza y la belleza de la naturaleza, y tambi√©n a lo fugaz de la vida, ya que su periodo de florecimiento solo se da en primavera y dura muy poco, alrededor de dos semanas. Yo te asoci√© con este √°rbol porque, para m√≠, representas belleza y pureza. Adem√°s, cuando te veo siento esa misma calidez que llega con la primavera despu√©s de un fr√≠o invierno. Asimismo, tus lindos cachetes rosados me recuerdan un poco a la colorcita (como dir√≠as t√∫, jaja) de los p√©talos de este √°rbol, o mejor dicho, de su flor, que por cierto es mi favorita. No s√© si lo recuerdas, pero el collar que te regal√© en Tarapoto fue un intento de simbolizar esto. Personalmente no me convenci√≥ del todo al comprarlo, pero fue lo m√°s parecido que encontr√© a este √°rbol.`
     },
     {
        id: crypto.randomUUID(),
        title: "Carta 4 ‚Äî FUTURO",
        tags: ["amor", "despedida"],
        date: "2025-08-15",
        content: `Sabiendo que este es nuestro √∫ltimo a√±o en el colegio, recuerda siempre lo que hablamos sobre no perder el tiempo y aprovechar todas las oportunidades que se te presenten en la vida. Aprovecha cada una de ellas, siempre y cuando sean de utilidad para tu futuro y realizaci√≥n como persona. Recuerda tambi√©n elegir una profesi√≥n que te guste, no una que te impongan. Por mi parte, doy fe de que, en lo que sea que escojas, vas a brillar. Eso s√≠, siempre esfu√©rzate y af√©rrate a tu meta. No te lo digo solo porque s√≠, te lo digo porque logr√© ver ciertas cualidades en ti, y por ellas te admiro. Te deseo los mayores √©xitos, y que Dios y tu familia siempre est√©n contigo.
Yo deseo que, m√°s adelante, quiz√° podamos volver a vernos, ya sea por casualidad o porque nunca perdimos el contacto, aunque no hablemos mucho. Sea cual sea la situaci√≥n en que coincidamos nuevamente, quiero y deseo poder verte siendo una mujer que refleje √©xito y felicidad con la vida que lograste construirte. Principalmente, deseo que sigas teniendo buenos lazos con tu familia, puesto que ellos jam√°s te dar√°n la espalda y siempre caminar√°n contigo. Personalmente, yo considero exitosa a una persona cuando, al preguntar por ella, todos solo tienen buenos comentarios, aun cuando no est√© forrada en dinero. Recuerda que lo m√°s importante en la vida es seguir siendo humilde y respetuosa.
Por mi parte, ya sabes que dar√© lo mejor de m√≠ para conseguir mi meta de ser uno de los mejores m√©dicos. Tambi√©n trabajar√© en mi desarrollo personal, para que cuando nos volvamos a ver, veas que s√≠ tuve un cambio para bien. S√© que decirlo es f√°cil, pero tambi√©n s√© que lo har√©. Tardar√©, s√≠, pero lo lograr√©.
No olvides que me dijiste que si abr√≠as un restaurante o un men√∫, o lo que fuera, ibas a ponerle ‚ÄúQUEMADO‚Äù a uno de los platos. ¬°Pobre de m√≠ si llego y no encuentro un plato con ese nombre! üòù (Eso es por la foto en la que sacas la lengua, jajaja).
Ya ver√°s que alg√∫n d√≠a llegar√°s al hospital donde estar√© trabajando, y yo mismo te sacar√© muestras de sangre‚Ä¶ ya tengo juradas tus venas, ¬°no lo olvides! Jajaja, cruda.
S√© que mi humor y mis chistes son terribles, pero r√≠ete al menos un poquito con ellos.`
‚ÄÉ   },
    {
        id: crypto.randomUUID(),
        title: "Carta 5 ‚Äî ATRAPADO EN TU MAREA",
        tags: ["amor", "despedida"],
        date: "2025-08-15",
        content: `A veces t√∫ eres como este inmenso y vasto mar: dura e implacable. Cada vez que estoy cerca de ti, con tus inmensas olas me alejas, impidiendo que este ni√±o encuentre un puerto seguro en tu ser.
Como un bravo mar al caer la oscura noche, te vuelves m√°s violenta y menos segura para m√≠. Pero eso no me importa, ni me importar√° nunca, porque con tal de sentirte cerca de m√≠ elijo aventurarme en tus aguas, aun sabiendo el riesgo que corro.
Aunque me ahogue en vagas ilusiones que se desvanecen como espuma en la orilla, s√© que tarde o temprano entender√© el peligro de seguir persigui√©ndote.
Pero, tal como un ni√±o peque√±o e inocente, no aprender√© hasta que tus olas me arrastren, con toda su fuerza, sobre la arena.
Tal como este, escrib√≠ muchos m√°s a lo largo de estos dos a√±os. No obstante, por la verg√ºenza y el roche, nunca te los di y termin√© borr√°ndolos. De m√°s est√° decir que t√∫, junto con mi estado de √°nimo, fuiste mi inspiraci√≥n para escribir.

Este texto ‚Äîo poema, como suelo llamarlo yo‚Äî refleja, en cierta manera, la historia que viv√≠a a diario tratando de acercarme a ti. Pero, por muchos factores que hoy en d√≠a, al pensarlo, veo que fueron simples e insignificantes, me terminaba acobardando. Porque, de alguna manera, me sent√≠a un poco intimidado por ti. Confieso eso.`
    },
    {
        id: crypto.randomUUID(),
        title: "Carta 6 ‚Äî HASTA QUE‚Ä¶‚Ä¶",
        tags: ["amor", "despedida"],
        date: "2025-08-15",
        content: `Como dicen por ah√≠, todo lo bueno tiene su final. Para m√≠, esto de decirte adi√≥s no es f√°cil, ya que, al despedirme de ti, se ir√°n tambi√©n muchos sentimientos y sensaciones que solo t√∫ lograste despertar en m√≠ sin propon√©rtelo. S√© que voy a extra√±arte demasiado; la sola idea de que cada vez est√° m√°s cerca el √∫ltimo d√≠a de clases me pone muy triste. Qui√©n sabe, quiz√° ese d√≠a no pueda controlar mis emociones y termine llorando. Solo quiero decirte que estas peque√±as cartas que te he escrito son lo m√°s parecido a un resumen de todo lo que en alg√∫n momento llegu√© a sentir por ti. Y tambi√©n quiero expresarte que te voy a recordar por varios a√±os m√°s, pues como ya te dije ‚Äîy lo recalco nuevamente‚Äî, ser√°s parte de los mejores momentos sentimentales que he podido experimentar en mi corta vida. S√© que puede sonar exagerado lo que escribo, pero quiz√°s contigo s√≠ me enamor√© por primera vez en mi vida, jeje.
Creo que esto, m√°s que un adi√≥s, ser√≠a m√°s bien un HASTA QUE LA VIDA NOS VUELVA A ENCONTRAR. No lo s√©, todo es tan incierto‚Ä¶ pero doy fe y esperanza de ello. Y cuando suceda, te recordar√© que t√∫ dec√≠as ‚ÄúNO‚Äù, Marimar.
Por √∫ltimo, quiero decirte que, al entregarte esto, es mi manera de darle un cierre y un poco de paz a mis sentimientos, para poder sentirme mejor conmigo mismo. Porque, al final, aunque no logr√© dec√≠rtelo en persona, con mi propia voz, al menos encontr√© en la escritura una forma de expresarte todo lo que sent√≠a.
As√≠ es como decid√≠ poner fin a esta monta√±a rusa de sentimientos obsesivos y locos que viv√≠ por ti.
Hasta un futuro no muy lejano, mi sitio de amor. Cu√≠date, y recuerda que, si alg√∫n d√≠a necesitas a alguien con quien hablar o alguien que te d√© una mano, puedes contar conmigo. No dudes en buscarme, porque encontrarme ser√° f√°cil‚Ä¶ y m√°s a√∫n si se trata de ti.
TE QUIERE POR MONTONES, JDCR`
     }     
    ];

    // Estado
    let state = {
      q: new URLSearchParams(location.search).get('q') || '',
      tag: new URLSearchParams(location.search).get('tag') || '',
      letters: [...LETTERS],
      editingId: null,
      readingId: null,
    };

    // UI refs
    const list = document.getElementById('list');
    const empty = document.getElementById('empty');
    const q = document.getElementById('q');
    const filterTag = document.getElementById('filterTag');
    const countPill = document.getElementById('countPill');
    const filterPill = document.getElementById('filterPill');

    const reader = document.getElementById('reader');
    const readerTitle = document.getElementById('readerTitle');
    const readerContent = document.getElementById('readerContent');
    const readerMeta = document.getElementById('readerMeta');
    const closeReader = document.getElementById('closeReader');
    const copyBtn = document.getElementById('copyBtn');
    const printBtn = document.getElementById('printBtn');
    const downloadBtn = document.getElementById('downloadBtn');

    const editor = document.getElementById('editor');
    const editorTitle = document.getElementById('editorTitle');
    const saveCard = document.getElementById('saveCard');
    const cancelEdit = document.getEle
